\section{Configuring the MCU with STM32CubeMX}

You can use the STM32CubeMX tool to create the necessary config. files to enable the GPIO Pins. 
In this tutorial Iâ€™m going to explain how you can modify the generated GPIO configs and add additional 
GPIOs. 

This tutorial uses the following equipment: 
- NUCLEO-F103RB Board 
- Keil uVision 5 with the necessary packages for Nucleo boards installed 
- STLink USB Driver 
- STM32CubeMX 

\subsection{STM32CubeMX}

Generating the config. files from STM32CubeMX.  

1. Open STM32CubeMX and open a new project. \\
2. Select the Nucleo-F103RB from the Borards tab \\ 
3. Enable FreeRTOS \\
4. Set the RCC (HSE \& LSE) to Crystal/Ceramic Resonator \\
5. Enable the USART2 port in Asynchronous mode \\
6. Set any GPIO to Output or Input (I am using PB13, PB14 and PC4) \\
7. Go to Project > Generate code \\
8. Enter a project name and select MDK-ARM V5 \\
9. Generate the code and open the project in Keil uVision \\



\begin{lstlisting}[style=CStyle]
{ 

  GPIO_InitTypeDef GPIO_InitStruct; 
 
  /* GPIO Ports Clock Enable */ 
  __GPIOC_CLK_ENABLE(); 
  __GPIOD_CLK_ENABLE(); 
  __GPIOA_CLK_ENABLE(); 
  __GPIOB_CLK_ENABLE(); 
 
  /*Configure GPIO pin : B1_Pin */ 
  GPIO_InitStruct.Pin = B1_Pin; 
  GPIO_InitStruct.Mode = GPIO_MODE_EVT_RISING; 
  GPIO_InitStruct.Pull = GPIO_NOPULL; 
  HAL_GPIO_Init(B1_GPIO_Port, &GPIO_InitStruct); 
 
  /*Configure GPIO pin : LD2_Pin */ 
  GPIO_InitStruct.Pin = LD2_Pin; 
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP; 
  GPIO_InitStruct.Speed = GPIO_SPEED_LOW; 
  HAL_GPIO_Init(LD2_GPIO_Port, &GPIO_InitStruct); 
 
  /*Configure GPIO pin : PC4 */ 
  GPIO_InitStruct.Pin = GPIO_PIN_4; 
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;         // digital Input 
  GPIO_InitStruct.Pull = GPIO_NOPULL; 
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct); 
 
  /*Configure GPIO pin : PB13 */ 
  GPIO_InitStruct.Pin = GPIO_PIN_13; 
  GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;        // analog Input 
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct); 
 
  /*Configure GPIO pin : PB14 */ 
  GPIO_InitStruct.Pin = GPIO_PIN_14; 
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;     // digital Output 
  GPIO_InitStruct.Speed = GPIO_SPEED_LOW; 
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct); 
 
}
\end{lstlisting}


